<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Melcion Ciudad Bosch">
<meta name="dcterms.date" content="2024-11-13">

<title>Predicción oleaje</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Pred_olas_files/libs/clipboard/clipboard.min.js"></script>
<script src="Pred_olas_files/libs/quarto-html/quarto.js"></script>
<script src="Pred_olas_files/libs/quarto-html/popper.min.js"></script>
<script src="Pred_olas_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Pred_olas_files/libs/quarto-html/anchor.min.js"></script>
<link href="Pred_olas_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Pred_olas_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Pred_olas_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Pred_olas_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Pred_olas_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#analisis-exploratorio" id="toc-analisis-exploratorio" class="nav-link" data-scroll-target="#analisis-exploratorio">Analisis exploratorio:</a></li>
  <li><a href="#surf-rating" id="toc-surf-rating" class="nav-link" data-scroll-target="#surf-rating">Surf-Rating</a></li>
  <li><a href="#descripción-por-regresión-lineal" id="toc-descripción-por-regresión-lineal" class="nav-link" data-scroll-target="#descripción-por-regresión-lineal">Descripción por regresión lineal</a></li>
  <li><a href="#contraste-de-la-hipótesis" id="toc-contraste-de-la-hipótesis" class="nav-link" data-scroll-target="#contraste-de-la-hipótesis">Contraste de la hipótesis</a>
  <ul class="collapse">
  <li><a href="#afecta-la-dirección-del-viento-a-las-características-de-la-ola" id="toc-afecta-la-dirección-del-viento-a-las-características-de-la-ola" class="nav-link" data-scroll-target="#afecta-la-dirección-del-viento-a-las-características-de-la-ola">Afecta la dirección del viento a las características de la ola?</a></li>
  <li><a href="#la-calidad-de-la-ola-esta-relacionada-con-una-variación-de-la-energía" id="toc-la-calidad-de-la-ola-esta-relacionada-con-una-variación-de-la-energía" class="nav-link" data-scroll-target="#la-calidad-de-la-ola-esta-relacionada-con-una-variación-de-la-energía">La calidad de la ola esta relacionada con una variación de la energía?</a></li>
  </ul></li>
  <li><a href="#conclusión" id="toc-conclusión" class="nav-link" data-scroll-target="#conclusión">Conclusión</a></li>
  <li><a href="#anexo" id="toc-anexo" class="nav-link" data-scroll-target="#anexo">Anexo</a>
  <ul class="collapse">
  <li><a href="#construcción-de-la-base-de-datos" id="toc-construcción-de-la-base-de-datos" class="nav-link" data-scroll-target="#construcción-de-la-base-de-datos">Construcción de la base de datos</a></li>
  <li><a href="#definición-del-test-de-hotelling" id="toc-definición-del-test-de-hotelling" class="nav-link" data-scroll-target="#definición-del-test-de-hotelling">Definición del test de Hotelling</a></li>
  </ul></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias">Referencias</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicción oleaje</h1>
<p class="subtitle lead">20582- Análisis de Datos para el GMAT</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Melcion Ciudad Bosch </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Podemos encontrar todo el código en el <a href="https://github.com/mcbosch/Prediccion-oleaje/tree/main">repositorio</a> de GitHub</p>
<section id="introducción" class="level1">
<h1>Introducción</h1>
<p>La predicción de la situación costera es muy importante para logística portuaria, para la pesca, para la seguridad de zonas costeras y para cualquier aficionado al deporte. El ayuntamiento de Bilbao dispone de una boya para medir la altura de una ola y su periodo en la playa de Arrietaram, una playa muy concurrida por los surfistas. Además disponen de un anómetro costero para medir también el viento. En este proyecto queremos proporcionar una predicción del oleaje y la calidad de la ola para hacer surf, asi ayudamos a los y las surfistas que frecuentan estas playas.</p>
<p>Un factor importante de la ola para el surfista es la energía ya que és una medida de con cuanta fuerza empujará la ola. Sin embargo no puedemos medir la energía de las olas con la boya que disponemos. Entonces han alquilado una boya a la empresa datawell para que tambien les mida la energía de las olas durante 100 días, una vez por la mañana con marea alta y otra por la tarde con marea baja.</p>
<div style="text-align: center;">
<p><img src="playa.jpg" alt="Arrietaram" width="250px"></p>
</div>
<p>Para proporcionar una web de predicción del oleaje modelizaremos la energía de las ola con los datos que puede proporcionar su boya. Además definiremos una variable que nos diga la calidad de la ola y miraremos si podemos relacionarla también con los datos que tenemos.</p>
<p>Las muestras de datos són aleatorias generadas a partir de funciones de R. Para aportar realismo hemos hecho una interpretación de datos que hemos obtenido de aplicaciones como WindGuru, Windy o TodoSurf (que solo son semanales). Además para la generación de datos definimos una dependencia temporal, ya que no seria lógico que hoy hubiese olas de dos metros y a las 12 horas el mar este en calma.</p>
<p>Planteamos la hipotesis de que un viento de tierra viene relacionado con una disminución de la energía y la altura, pero un aumento del periodo. Y que para un viento de mar provoca el efecto contrario. Para hacer este contraste realizaremos un contraste de medias restringiendo nuestros datos a los dos tipos de viento. Además veremos que definiendo una calidad de la ola, esta relacionado con una media de la energía más alta.</p>
<p>Añadiremos la variable SST que indica la temperatura de la superficie del agua de la base de datos de <span class="citation" data-cites="author2023web">(<a href="#ref-author2023web" role="doc-biblioref">Akdag, 2023</a>)</span>. Hemos utilizado durante el proyecto resultadis teóricos de los apuntes de <span class="citation" data-cites="apuntes">(<a href="#ref-apuntes" role="doc-biblioref">García, 2024</a>)</span></p>
</section>
<section id="analisis-exploratorio" class="level1">
<h1>Analisis exploratorio:</h1>
<p>Observemos nuestros datos. En el estudio de () salió que el termostato de la bolla fallo algunos dias, lo podemos observar en la siguiente tabla. Entonces deberemos filtrar estos datos</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 200
Columns: 8
$ V   &lt;dbl&gt; 8.467888, 8.877916, 5.281422, 7.123419, 13.959334, 10.373866, 4.20…
$ En  &lt;dbl&gt; 227.41502, 180.63169, 122.75817, 124.56852, 208.10093, 268.27876, …
$ P   &lt;dbl&gt; 13.334642, 10.936226, 8.276019, 8.376262, 10.926849, 11.991172, 5.…
$ A   &lt;dbl&gt; 1.4497113, 1.2515921, 1.1708505, 1.1651771, 1.4419729, 1.6898622, …
$ DV  &lt;chr&gt; "S", "E", "W", "E", "SW", "W", "NE", "NW", "SW", "SW", "E", "E", "…
$ M   &lt;chr&gt; "BAJA", "ALTA", "BAJA", "ALTA", "BAJA", "ALTA", "BAJA", "ALTA", "B…
$ DAT &lt;chr&gt; "2017-03-26 tarde", "2017-03-27 mañana", "2017-03-27 tarde", "2017…
$ SST &lt;dbl&gt; -99.90, -99.90, -99.90, -99.90, -99.90, -99.90, -99.90, -99.90, 24…</code></pre>
</div>
</div>
<p>Observamos que trabajamos con 8 variables, en el siguiente oren:</p>
<ul>
<li><em>Viento</em> en nudos</li>
<li><em>Energía</em> en kJ</li>
<li><em>Periodo</em> em segundos</li>
<li><em>Altura</em> de la ola en metros</li>
<li><em>Dirección viento</em> que puede tomar los valores: Norte (N), Este(E), Oeste(W), Sud(S), Nor-este(NE), Nor-oeste(NW), sureste(SE) y suroeste (SW)</li>
<li><em>Marea</em> que puede ser alta o baja (en nuestro experimento hacemos una medición con la marea alta y otra con la marea baja, que serian cada 12 horas)</li>
<li><em>Fecha</em> que es el dia y hora de la medición</li>
<li><em>SST</em>, Surface Sea Temperature, una variable de la base de datos <span class="citation" data-cites="author2023web">(<a href="#ref-author2023web" role="doc-biblioref">Akdag, 2023</a>)</span></li>
</ul>
<p>Para hacer un estudio de nuestras variables primero reoordenaremos nuestros datos y filtremos en los que fallo el termostato. Calculemosentonces la varianza generalizada y la varianza total. Estos dos datos nos dice la dispersión de nuestras observaciones, para tener una idea intuitiva de como son nuestros datos. Entonces obteemos los siguientes resultados:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Varianza total:  132.391817811602"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Varianza generalizada:  2445.3830062346"</code></pre>
</div>
</div>
<p>Pues observamos que obtenemos datos bastante dispersos sin embargo al mirar la matriz vemos que la variable que aporta toda esta dispersión es en mayor proporción la energía, de hecho observemos estos valores cuando no tenemos en cuenta la energia:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Varianza total:  0.370485002054203"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Varianza generalizada:  19.736492543612"</code></pre>
</div>
</div>
<p>Hacemos un analisis de las relaciones de nuestras variables con un mapa de calor, asi podremos estudiar cual de nuestros objetivos para probar la hipótesis puede resultar más interesante. Observemos el siguiente mapa de calor</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Pred_olas_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como podemos observar hay una alta correlación positiva entre el viento y la altura de las olas. Y la altura tiene una relación positiva con la energía. Sin embargo, como veremos después una disminución del periodo viene relacionado con peores olas, y la matriz de correlaciones nos indica que un aumento del viento puede llevar a una disminución del periodo.</p>
<p>Para realizar los futuros contrastes nos interesa saber si nuestras variables siguen una distribución normal. Para ello hemos realizado un shapiro test en cada variable y no hay nada que nos haga suponer lo contrario. A excepción de la temperatura. Pero como hemos visto en el mapa de calor hay una baja correlación de las variables con la temperatura, y para segun que tratamientos la obviaremos.</p>
</section>
<section id="surf-rating" class="level1">
<h1>Surf-Rating</h1>
<p>El surf-rating se definira como una variable cualitativa de 6 niveles. Esta variable indicará un tipo de calidad de la ola para hacer surf, la calidad de la ola se expresa en orden creciente como:</p>
<ul>
<li><em>Baja y poca fuerza (BPF)</em>: Olas de menos de 0.5 metros o de energia menor que 80kJ.</li>
<li><em>Olas bajas (B)</em>: Olas de entre 0.6 y 0.9 metros, con una energía mayor de 80 kJ.</li>
<li><em>Oleaje medio movido (MM)</em>: Olas de entre 1 y 1.4 metros, con viento a sur, sur-osete o sur-este.</li>
<li><em>Oleaje medio glass (MG)</em>: Olas de entre 1 y 1.4 metros, con viento de tierra.</li>
<li><em>Oleaje alto movido (AM)</em>: Olas de mas de 1.5 metros, con viento a sur.</li>
<li><em>Oleaje alto glass (AG)</em>: Olas de mas de 1.5 metros, con viento de tierra.</li>
</ul>
<p>Esta variable sera muy interesante para el surfista. También añadiremos una condición de la ola en función del periodo clasificandolas en 4 estrellas. Cuanto mayor es un periodo más interesante es para el surfista, ya que hay un mayor tiempo de recuperación.</p>
<ul>
<li><em>1 Estrella</em> : La ola es BPF,B o es MM con un periodo menor que 8.5</li>
<li><em>2 Estrellas</em>: La ola es MM con periodo mayor que 8.5 o MG con un periodo hasta 10</li>
<li><em>3 Estrellas</em>: La ola es MG con periodo mayor que 10 o AM, o AG con periodo hasta 10</li>
<li><em>4 Estrellas</em>: La ola es AG con un periodo mayor que 10</li>
</ul>
<p>Ahora supongamos que un surfista se va un puente a Bilbao y le gustaria saber si tendra buenas olas. Para ello modelizamos con una multinomial <span class="math inline">\(X = (X_1,X_2,X_3,X_4)\)</span> donde <span class="math inline">\(X_i\)</span> es el número de dias que ha habido con una calidad de olas <span class="math inline">\(i\)</span>. Entonces <span class="math inline">\(X \sim \text{Multinom}(n,p_1,p_2,p_3,p_4)\)</span> donde las <span class="math inline">\(p_i\)</span> son las siguientes probabilidades.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>multiN_data
         1          2          3          4 
0.16666667 0.43229167 0.33333333 0.06770833 </code></pre>
</div>
</div>
<p>Para el surfista de nivel medio que va a estar un puente en Bilbao le interesa saber que cual es la probabilidad de que en 4 dias haya al menos un dia de olas de calidad 3 <span class="math inline">\(P(MG \geq 1)\)</span>.</p>
<p><span class="math display">\[
P(X_3 \geq 1) = 1 - P(X_3 = 0)
\]</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Probabilidad de que un dia haya olas de calidad 3:  0.802"</code></pre>
</div>
</div>
<p>Sin embargo a un surfista profesional le gustaria saber cuando debe comprarse el billete de vuelta para tener al menos un dia de calidad 4 con una probabilidad del 0.9.</p>
<p><span class="math display">\[
1-(1-p_4)^{n} \geq 0.9 \Longleftrightarrow log(0.1) \geq nlog(1-p_4) \Longleftrightarrow \frac{log(0.1)}{log(1-p_4)} \leq n
\]</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       4 
32.84267 </code></pre>
</div>
</div>
<p>Entonces el surfista debería ir un mes para poderse asegurar días de una calidad 4.</p>
</section>
<section id="descripción-por-regresión-lineal" class="level1">
<h1>Descripción por regresión lineal</h1>
<p>Supongamoos ahora que nuestra boya mide el periodo, la altura y tenemos un medidor de la velocidad del viento. Entonces intentaremos diseñar un modelo de regresión lineal para aproximar cual seria la energía.</p>
<p>La energía de la ola es un dato importante para el surfista porque así sabra si el tipo de ola es el adequado para la tabla que utiliza y su experiencia.</p>
<p>En el análisis exploratorio de nuestras variables hemos visto que podíamos suponer normalidad en la energía pero no era así para la temperatura, veremos que no es de gran relevancia esta variable. Entonces si <span class="math inline">\(X_1,X_2,X_3\)</span> y <span class="math inline">\(X_4\)</span> son los datos viento, la altura, el periodo y SST respectivamente deseamos crear un modelo de la forma:</p>
<p><span class="math display">\[ Y = \beta_0 + \beta_1X_1+\beta_2X_2 + \beta_3X_3 + \beta_4X_4+\epsilon\]</span> Y estimar los parámetros <span class="math inline">\(\beta = (\beta_0,\beta_1,\beta_2,\beta_3,\beta_4)\)</span>. En este análisis <span class="math inline">\(\epsilon\)</span> es el termino de error y sigue una multinormal centrada en el cero y homocedática. Entonces <span class="math inline">\(Y\sim \mathcal{N}(X\beta,\sigma^2I)\)</span> donde <span class="math inline">\(X = (\underline{1},X_1,X_2,X_3,X_4)\)</span>. Si calculamos la función de densidad en función de los parámetros obenemos la siguiente formula:</p>
<p><span class="math display">\[
f_{\beta, \sigma^2}(Y) = \frac{1}{(2\pi\sigma^2)^{\frac{n}{2}}}exp\left\{-\frac{1}{\sigma^2}(Y-X\beta)^T(Y-X\beta) \right\}
\]</span></p>
<p>Sin embargo lo que varia son los parámetros, y además lo único que nos interesa es maximizarla. Entonces como la función logaritmo es creciente definimos la función información como:</p>
<p><span class="math display">\[
l_Y(\beta,\sigma^2) = log(f_{\beta,\sigma^2}(Y))
\]</span></p>
<p>Finalmente estudiaremos la variación de esta función con la función Score que la definimos como la parcial de <span class="math inline">\(\beta\)</span>. Esta función es un indicador de la variabilidad de la verosimilitud de unos parámetros. Entonces valores proximos al cero nos indican proximidad al máximo de la función de información <span class="math inline">\(l_Y\)</span>. La función Score es:</p>
<p><span class="math display">\[
Score(\beta) := \frac{\partial l_Y}{\partial\beta}(\beta,\sigma^2) = \frac{1}{\sigma^2}X^T(Y-X\beta)
\]</span></p>
<p>Entonces con la función lm de R podemos calcular los coeficientes con la fórmula <span class="math inline">\((X^tX)^{-1}(X^tY)\)</span> y verificar con la función Score. Si hacemos el cálculo obtemos:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              V1             V             P             A           SST
En -3.582876e-09 -2.787826e-08 -3.564384e-08 -4.626443e-09 -9.580924e-08</code></pre>
</div>
</div>
<p>Comprobando así que nos situamos aproximadamente en un máximo de verosimilitud.Son todas las variables relevantes? Cuando llamamos a la función lm() de R nos indica que valores son más o menos significantes en función del p-valor que aparece de hacer el contraste de hipótesis en que un factor <span class="math inline">\(\beta_i = 0\)</span>. Entonces en nuestro caso el mayor p-valor es el de la temperatura.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X[, 2] + X[, 3] + X[, 4] + X[, 5])

Residuals:
    Min      1Q  Median      3Q     Max 
-53.215 -13.051   1.496  11.238  52.286 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -140.7547    61.9806  -2.271   0.0243 *  
X[, 2]         0.6603     0.6514   1.014   0.3121    
X[, 3]        15.4426     0.6215  24.847   &lt;2e-16 ***
X[, 4]       139.7096    12.1479  11.501   &lt;2e-16 ***
X[, 5]        -1.4962     2.2103  -0.677   0.4993    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.1 on 187 degrees of freedom
Multiple R-squared:  0.8527,    Adjusted R-squared:  0.8495 
F-statistic: 270.6 on 4 and 187 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Si consideramos <span class="math inline">\(\beta_4 = 0\)</span> y repetimos el proceso observamos que la medida de bondad de ajuste no se ve variada, y el viento sigue sin ser significante. Definiremos pues nuestro modelo lineal únicamente con el periodo y la altura.</p>
<p>Y podemos observar en la siguiente gráfica que este modelo nos da valores muy próximos a lo deseado.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Pred_olas_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="contraste-de-la-hipótesis" class="level1">
<h1>Contraste de la hipótesis</h1>
<section id="afecta-la-dirección-del-viento-a-las-características-de-la-ola" class="level3">
<h3 class="anchored" data-anchor-id="afecta-la-dirección-del-viento-a-las-características-de-la-ola">Afecta la dirección del viento a las características de la ola?</h3>
<p>Definiremos dos ‘poblaciones’ en función de la dirección del viento y realizamos un test del tipo:</p>
<p><span class="math display">\[
H_0: \mathbb{\mu_1} = \mu_2
\]</span> Pero siguen nuestras distribuciones una multinomial? Si realizamos un test de normalidad de cada una de las variables observamos que si, exceptuando la temperatura que no la tendremos en cuenta por la baja correlación y ya que estamos interesados en la energía. Haremos un hotelling test nosotros y lo compararemos con la función de R.</p>
<p>Sabemos la relación de la F de fisher-Snedecor con la T-Hotteling es:</p>
<p><span class="math display">\[
F^p_{m+p-1} = \frac{m+p-1}{mp}T^2(p,m)    
\]</span></p>
<p>Entonces lo utilizaremos para calcular el p-valor con la función pf de R. Después comparamos nuestro resultado con la función test.hotelling() del paquete Hotelling. Podemos ver el código de nuestra función en el anexo.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  Valor_estadistico[,1] df_num df_den pvalor[,1]
                  &lt;dbl&gt;  &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1                  4.46      4    140      0.364</code></pre>
</div>
</div>
<p>Unos valores muy parecidos a la función de R que son los siguientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Test stat:  4.5194 
Numerator df:  4 
Denominator df:  140 
P-value:  0.3562 </code></pre>
</div>
</div>
</section>
<section id="la-calidad-de-la-ola-esta-relacionada-con-una-variación-de-la-energía" class="level3">
<h3 class="anchored" data-anchor-id="la-calidad-de-la-ola-esta-relacionada-con-una-variación-de-la-energía">La calidad de la ola esta relacionada con una variación de la energía?</h3>
<p>Para este estudio nos gustaria combrovar que una mayor calidad viene relacionada con una mayor energía, veamos como son las medias en cada nivel:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Pred_olas_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Aunque a simple vista parece que la respuesta es si, en el nivel 4 hay pocas observaciones teniendo en cuenta su probabilidad. Optaremos para este contraste definir dos subpoblaciones en función de si tienen dos estrellas o menos y si tienen 3 o más. Y hacemos un test de hotelling como el definido anteriormente. Y obtenemos los siguientes resultados:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Pred_olas_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  Valor_estadistico[,1] df_num df_den pvalor[,1]
                  &lt;dbl&gt;  &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1                  58.8      1    190   8.63e-13</code></pre>
</div>
</div>
<p>Este p-valor, indica una probabilidad muy baja de haber observado el valor del estadiístico suponiendo que las medias de las energías son iguales. Al ser el P-valor tan cercano a cero no sería muy verosímil nuestra hipótesis. Entonces la energía en las olas de mayor calidad esta desplazada (en concreto es mayor)</p>
</section>
</section>
<section id="conclusión" class="level1">
<h1>Conclusión</h1>
<p>Como hemos observado la energía es un factor importante para la calidad de la ola, y una mayor calidad de esta relacionado con una mayor energía. El modelo de regresión para preveer la energía puede ser muy útil aunque a veces haya errores de 20 KJ o más. La magnitud de estos errores también pueden venir relacionadas con la dependencia temporal que hemos creado en la base de datos, ya que el modelo de regresión no tiene en cuenta los valores de los días anteriores. Tener en cuenta que variables como la altura o la energía no pueden ser independientes al tiempo ya que hay un ‘tiempo de recuperación’. No es como quien tira un dado.</p>
<p>Para el contraste de hipótesis no hemos utilizado la temperatura. Eso no significa que sean independientes, de hecho no lo són. Lo hemos hecho asi porque la temperatura no seguia una distribución normal y no disponía de tiempo ni de conocimientos en los que no tuviera que utilizar la normalidad de mis variables. Como la variable principal del estudio era la energía y había poca correlacion la hemos obviado.</p>
<p>Hay que tener en cuenta que hemos creado nuestra propia base de datos (veáse como en el anexo), que para modelar datos metereológicos debemos ir con precaución ya que no se expresan los picos que se observan en la naturaleza como las rachas de viento. Es más recomendable crear un modelo númerico mezclando modelos físicos que describan el comportamiento y la estadística. Por ejemplo el Puerto de Estado tiene un conjunto de datos SIMAR creados a partir de modelos numéricos mucho más precisos. Aun así suelen trabajar con el mismo problema de los picos.</p>
</section>
<section id="anexo" class="level1">
<h1>Anexo</h1>
<section id="construcción-de-la-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="construcción-de-la-base-de-datos">Construcción de la base de datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>covarianza <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">77</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="fl">0.25</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">77</span>, <span class="dv">5000</span>, <span class="dv">134</span>, <span class="dv">10</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span><span class="dv">2</span>, <span class="dv">134</span>, <span class="dv">6</span>, <span class="fl">0.12</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fl">0.25</span>, <span class="dv">10</span>, <span class="fl">0.12</span>, <span class="fl">0.05</span>), <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>medias <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">164</span>, <span class="dv">10</span>, <span class="fl">1.3</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>datos_numericos <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">200</span>, <span class="at">mu =</span> medias, covarianza) <span class="sc">%&gt;%</span> <span class="fu">as.tibble</span>()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datos_numericos) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'V'</span>,<span class="st">'En'</span>,<span class="st">'P'</span>,<span class="st">'A'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Limitamos a resultados realistas</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>datos_numericos <span class="ot">&lt;-</span> datos_numericos <span class="sc">%&gt;%</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">pmax</span>(V, <span class="dv">0</span>),    </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">En =</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(En, <span class="dv">1</span>), <span class="dv">5000</span>),  <span class="co"># Energía entre 1 y 5000</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">P =</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(P, <span class="dv">5</span>), <span class="dv">20</span>),      <span class="co"># Periodo entre 5 y 20 s</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(A, <span class="dv">0</span>), <span class="dv">20</span>)      <span class="co"># Altura entre 0 y 20 m</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Suponemos que nuestra bolla mide cada 12 horas</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>direccion_viento <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'N'</span>,<span class="st">'W'</span>,<span class="st">'S'</span>,<span class="st">'E'</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'NW'</span>,<span class="st">'NE'</span>,<span class="st">'SW'</span>,<span class="st">'SE'</span>),<span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>marea <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"ALTA"</span>, <span class="st">"BAJA"</span>), <span class="at">times =</span> <span class="dv">100</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>primer_dia <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-01"</span>) </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>fechas <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> primer_dia, <span class="at">by =</span><span class="st">'day'</span>, <span class="at">length.out =</span> <span class="dv">100</span>) </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>DAT <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  DAT <span class="ot">=</span> <span class="fu">c</span>(DAT, <span class="fu">paste</span>(<span class="fu">as.character</span>(fechas[i]), <span class="st">'mañana'</span>),<span class="fu">paste</span>(<span class="fu">as.character</span>(fechas[i]), <span class="st">'tarde'</span>))</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>datos_cual <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">DV =</span> direccion_viento,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">M  =</span> marea,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">DAT =</span> DAT)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadimos una dependencia temporal</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">200</span>) {</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  datos_numericos<span class="sc">$</span>A[i] <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="sc">*</span> datos_numericos<span class="sc">$</span>A[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.5</span> <span class="sc">*</span> datos_numericos<span class="sc">$</span>A[i] <span class="sc">+</span> (datos_numericos<span class="sc">$</span>V[i]<span class="sc">/</span><span class="dv">8</span><span class="sc">*</span><span class="fl">1.3</span>)<span class="sc">*</span><span class="fl">0.2</span> </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  datos_numericos<span class="sc">$</span>En[i] <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="sc">*</span> datos_numericos<span class="sc">$</span>En[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.7</span> <span class="sc">*</span> datos_numericos<span class="sc">$</span>En[i]</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co"># unimos los datos numéricos y cualitativos</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(datos_numericos,datos_cual)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadimos una variable de otra base de datos</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>kaggle_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'kaggle_data.csv'</span>,<span class="at">header =</span> <span class="cn">TRUE</span>) </span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>datos_nuevos <span class="ot">&lt;-</span> kaggle_data  <span class="sc">%&gt;%</span>  </span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'8:00'</span>,Date.Time) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">'20:00'</span>,Date.Time)) <span class="sc">%&gt;%</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Date.Time,SST) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>)</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>fechas <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> primer_dia, <span class="at">by =</span><span class="st">'day'</span>, <span class="at">length.out =</span> <span class="dv">100</span>) </span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>DATK <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  DATK <span class="ot">=</span> <span class="fu">c</span>(DATK, <span class="fu">paste</span>(<span class="fu">as.character</span>(fechas[i]), <span class="st">'mañana'</span>),<span class="fu">paste</span>(<span class="fu">as.character</span>(fechas[i]), <span class="st">'tarde'</span>))</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>datos_nuevos <span class="ot">&lt;-</span> datos_nuevos <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date.Time =</span> DATK) </span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datos_nuevos) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'DAT'</span>,<span class="st">'SST'</span>)</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(datos_nuevos) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="definición-del-test-de-hotelling" class="level3">
<h3 class="anchored" data-anchor-id="definición-del-test-de-hotelling">Definición del test de Hotelling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>test_H <span class="ot">&lt;-</span> <span class="cf">function</span>(Y1,Y2){</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculamos la media y la matriz de covarianzas de la primera población</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  mu1 <span class="ot">=</span> <span class="fu">colMeans</span>(Y1) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">col</span>(Y1[<span class="dv">1</span>]))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">=</span> <span class="fu">cov</span>(Y1)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repetimos para la segunda población</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  mu2 <span class="ot">=</span> <span class="fu">colMeans</span>(Y2) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">col</span>(Y2[<span class="dv">1</span>]))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">=</span> <span class="fu">cov</span>(Y2)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Comprobamos que hay las mismas variables</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">length</span>(Y1)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">!=</span> <span class="fu">length</span>(Y2)){</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">print</span>(<span class="st">'WARNING: No hay el mismo número de variables'</span>))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Definimos constantes necesarias para el cálculo</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> (n1<span class="sc">+</span>n2 <span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span>p)<span class="sc">*</span>n1<span class="sc">*</span>n2<span class="sc">/</span>((n1<span class="sc">+</span>n2<span class="dv">-2</span>)<span class="sc">*</span>p<span class="sc">*</span>(n1<span class="sc">+</span>n2))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">=</span> (n1<span class="sc">*</span>S1<span class="sc">+</span>n2<span class="sc">*</span>S2)<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="dv">-2</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  S_inv <span class="ot">=</span> <span class="fu">solve</span>(S)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">Valor_estadistico =</span> <span class="dv">0</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">df_num=</span> p,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">df_den =</span> n1<span class="sc">+</span>n2<span class="dv">-1</span><span class="sc">-</span>p,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">pvalor=</span> <span class="dv">0</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculamos el p-valor y el valor del estadístico</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">=</span>  s<span class="sc">*</span><span class="fu">t</span>((mu2<span class="sc">-</span>mu1))<span class="sc">%*%</span>S_inv<span class="sc">%*%</span>(mu2<span class="sc">-</span>mu1)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  H<span class="sc">$</span>Valor_estadistico <span class="ot">=</span>t<span class="sc">*</span>((n1<span class="sc">+</span>n2<span class="dv">-2</span>)<span class="sc">*</span>p)<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="sc">-</span>p <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  H<span class="sc">$</span>pvalor<span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(t,p,n1<span class="sc">+</span>n2<span class="sc">-</span>p<span class="dv">-1</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(H)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="referencias" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-author2023web" class="csl-entry" role="listitem">
Akdag, M. (2023). <em>Ocean wave prediction</em>. <a href="https://www.kaggle.com/code/akdagmelih/ocean-wave-prediction-with-lstm?scriptVersionId=150440480&amp;cellId=1">https://www.kaggle.com/code/akdagmelih/ocean-wave-prediction-with-lstm?scriptVersionId=150440480&amp;cellId=1</a>
</div>
<div id="ref-apuntes" class="csl-entry" role="listitem">
García, I. M. (2024). <em>Apuntes analisis de datos</em>. <a href="https://github.com/AprendeR-UIB/AD.git">https://github.com/AprendeR-UIB/AD.git</a>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>